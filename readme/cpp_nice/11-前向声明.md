
## 在 C++中 什么时候使用 forward declaration   [编译器是顺序解析代码的]

前向声明 一种声明类型的方式，告诉**编译器某个类或结构体存在，但不提供其完整定义**。前向声明通常用于解决依赖关系和循环依赖问题。要知道，**编译器是按顺序**解析代码的，当它遇到一个类的声明或定义之前，它是不知道这个类的存在的。

~~~cpp
// File: ClassA.h
#ifndef CLASSA_H
#define CLASSA_H

class ClassB; // forward declaration，告诉 ClassA 文件中有 ClassB 的定义

class ClassA {
private:
    ClassB* myB;
public:
    void setB(ClassB* b);
};

#endif // CLASSA_H

// File: ClassA.cpp
#include "ClassA.h"
#include "ClassB.h" // full include

void ClassA::setB(ClassB* b) {
    myB = b;
}
~~~

一个循环依赖的例子, A，B 相互依赖，class B 在 class A 之前被前向声明，因此编译器在解析 class A 时知道 class B 的存在。然后，class B 可以引用 class A，从而解决了循环依赖问题。

~~~cpp
// Forward declaration of class B
class B;

class A {
private:
    B* bPtr;  // A class references B class
    ...
};

class B {
private:
    A* aPtr;  // B class references A class
    ...
};
~~~


## extern 和 前向声明 区别

对于函数，前向声明通常不需要extern关键字，因为函数的前向声明本身就意味着它在其他地方定义了。对于变量，extern关键字是必须的，以区分声明和定义。

extern 关键字用于指定变量或函数具有外部链接，并且在其他文件中定义。前向声明是告诉编译器某个符号的存在，但不一定涉及外部链接。

回顾：外部链接性允许不同的编译单元共享和访问相同的变量或函数。`extern` 修饰的全局变量具有外部链接（external linkage）。 所有翻译单元都可以访问同一个变量。

